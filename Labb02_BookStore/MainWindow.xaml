<Window x:Class="Labb02_BookStore.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Labb02_BookStore"
        xmlns:model="clr-namespace:Labb02_BookStore.Domain;assembly=Labb02_BookStore.Domain"
        xmlns:UI="clr-namespace:Labb02_BookStore.Presentation.ViewModels"
        xmlns:views="clr-namespace:Labb02_BookStore.Views"
        mc:Ignorable="d"
        WindowState="Maximized"
        Title="MainWindow" Height="450" Width="800"
        Icon="Icons/bookshelf_icon.ico">
        


    <Window.Resources>
        <Style TargetType="{x:Type TextBlock}" x:Key="RightJustifiedTextCell">
            <Setter Property="HorizontalAlignment" Value="Stretch"/>
            <Setter Property="TextAlignment" Value="Right"/>
        </Style>
    </Window.Resources>
    

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="2*" />
            <ColumnDefinition Width="3*" />
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>

        </Grid.RowDefinitions>
       
        <views:MenuView Grid.Row="0" Grid.ColumnSpan="2"/>

        <StackPanel Grid.Column="0" Grid.Row="1" VerticalAlignment="Top" Orientation="Vertical">
            <TextBlock Text="Book Stores" FontSize="20" Padding="6" FontWeight="Bold"></TextBlock>

            <Button 
                Grid.Row="0"
                Margin="5"
                Content="Add Store" 
                Width="65"
                Height="20"
                Command="{Binding OpenAddStoreDialogCommand}"
                >
            </Button>
            <Button 
                Grid.Row="0"
                Margin="5"
                Content="Edit Store" 
                Width="65"
                Height="20"
                Command="{Binding OpenEditStoreDialogCommand}"
                >
            </Button>
            <Button 
                Grid.Row="0"
                Margin="5"
                Content="Delete Store" 
                Width="65"
                Height="20"
                Command="{Binding DeleteStoreCommand}"
                >
            </Button>


            <TreeView x:Name="Stores" SelectedItemChanged="Stores_SelectedItemChanged" ItemsSource="{Binding BookStores}">
                <TreeView.Resources>

                    <Style TargetType="TreeViewItem">
                        <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                        <Setter Property="Background" Value="Transparent"/>
                        <Setter Property="BorderBrush" Value="Transparent"/>
                        <Setter Property="Padding" Value="4"/>

                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="TreeViewItem">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Border x:Name="Bd"
                                                Grid.Column="1"
                                                Background="{TemplateBinding Background}"
                                                CornerRadius="2"/>
                                        <ContentPresenter Grid.Column="1"
                                                          ContentSource="Header"
                                                          HorizontalAlignment="Stretch"
                                                          VerticalAlignment="Center"/>
                                        <ItemsPresenter Grid.Column="1"
                                                        Margin="18,0,0,0"/>
                                     </Grid>     
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter TargetName="Bd"
                                                    Property="Background"
                                                    Value="#FFE6F2FF"/>
                                        </Trigger>
                                        <Trigger Property="IsSelected" Value="True">
                                            <Setter TargetName="Bd"
                                                    Property="Background"
                                                    Value="#FFCCE5FF"/>     
                                        </Trigger>  
                                        <Trigger Property="IsEnabled" Value="False">
                                            <Setter Property="Opacity" Value="0.5"/>
                                        </Trigger>

                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Style>
                   <HierarchicalDataTemplate DataType="{x:Type model:BookStore}" ItemsSource="{Binding BookStores}">
                        <TextBlock FontSize="16" Padding="6">
                            <Run Text="{Binding Name}" />
                        </TextBlock>
                    </HierarchicalDataTemplate>
                </TreeView.Resources>
            </TreeView>

            <DataGrid x:Name="storeDetailGrid"
                  Grid.Column="0"
                  Grid.Row="2"
                  AutoGenerateColumns="True"  
                  IsReadOnly="False"
                  CanUserAddRows="False"
                  CanUserDeleteRows="False"
                  CanUserResizeColumns="False"
                  CanUserResizeRows="False"
                  CanUserReorderColumns="False"
                  CanUserSortColumns="True"
                  SelectionMode="Extended"
                  SelectionUnit="CellOrRowHeader"
                  RowHeaderWidth="20"
            >
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Store Name" Binding="{Binding Name}"/>
                    <DataGridTextColumn Header="Store Adress" Binding="{Binding Street}"/>
                    <DataGridTextColumn Header="Store Zipcode" Binding="{Binding Zipcode}" ElementStyle="{StaticResource RightJustifiedTextCell}"/>
                    <DataGridTextColumn Header="Store City" Binding="{Binding City}"/>
                    <DataGridTextColumn Header="Store Country" Binding="{Binding Country}"/>
                </DataGrid.Columns>



            </DataGrid>
        </StackPanel>

        <Grid Grid.Column="1" Grid.Row="1" VerticalAlignment="Top">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>


            <TextBlock Grid.Row="0"
                       FontSize="20"
                       FontWeight="Bold"
                       Padding="6">
                <Run Text="Current Inventory:" />
                <Run Text="{Binding ElementName=Stores, Path=SelectedItem.Name}" Foreground="#0077b6" />
            </TextBlock>
            
            <DataGrid 
              x:Name="myDataGrid"
              ItemsSource="{Binding Books}"
              SelectedItem="{Binding SelectedBook, Mode=TwoWay}"
              Grid.Row="1"
              AutoGenerateColumns="False"
              IsReadOnly="False"
              CanUserAddRows="False"
              CanUserDeleteRows="False"
              CanUserResizeColumns="False"
              CanUserResizeRows="False"
              CanUserReorderColumns="False"
              CanUserSortColumns="True"
              SelectionMode="Extended"
              SelectionUnit="CellOrRowHeader"
              RowHeaderWidth="20"
              HorizontalScrollBarVisibility="Hidden"
              AlternationCount="2"
              RowBackground="White"
              AlternatingRowBackground="#FFCCE5FF">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="ISBN13" Binding="{Binding Isbn13}" />
                    <DataGridTextColumn Header="Title" Binding="{Binding Isbn13Navigation.Title}" />
                    <DataGridTextColumn Header="Price" Binding="{Binding Isbn13Navigation.Price}" />
                    <DataGridTextColumn Header="Quantity" Binding="{Binding Balance}" />
                    <DataGridTemplateColumn Header="Edit Book">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Button Content="Edit"
                                Padding="8,2"
                                Command="{Binding DataContext.OpenBookEditWindowCommand,
                                                  RelativeSource={RelativeSource AncestorType=DataGrid}}"
                                CommandParameter="{Binding}" />
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                    <DataGridTemplateColumn Header="Edit Book">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Button Content="Delete"
                                    Padding="8,2"
                                    Command="{Binding DataContext.DeleteBookFromStoreCommand,
                                                      RelativeSource={RelativeSource AncestorType=DataGrid}}"
                                    CommandParameter="{Binding}" /> 
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                </DataGrid.Columns>
            </DataGrid>
        
        <StackPanel>
             <ComboBox 
             x:Name="selectBookComboBox"
             Grid.Column="1"
             Width="200"
             Margin="10"
             IsEditable="True"
             IsReadOnly="True"
             Text="Select a book..."
             VerticalAlignment="Center"
             DisplayMemberPath="Title"
             SelectedItem="{Binding SelectedBook, Mode=TwoWay}" 
             />




                <Button Content="Add Book" Width="auto" Command="{Binding AddBookToSelectedStoreCommand}"></Button>
        </StackPanel>

        </Grid>
    </Grid>
</Window>
